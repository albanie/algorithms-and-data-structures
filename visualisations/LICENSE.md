This code is modifed from https://bl.ocks.org/lsbardel/83ea5911884ae2773991eda6c11856b2 which is released under the 3-Clause BSD License.
